# Документация API

## Регистрация

Для создания нового пользователя необходимо выполнить запрос ```/user/registration``` указав электронную почту и пароль. 
Далее на указанную электронную почту придет сообщение с токеном (если используется dev окружение то сообщение можно увидеть в [mailHog](localhost:8025).

После получения токена для подтверждения почты нужно выполнить запрос ```/user/email/confirmation``` указав полученный из почты токен в header заголовка ```X-AUTH-TOKEN```.

## Сброс пароля

Для того чтобы сбросить пароль, нужно выполнить метод ```/user/password/reset``` и указать в нем свой email.
Далее на указанную почту придет токен который необходимо указать в запросе ```/user/password/reset/confiramtion``` указав в header параметр ```X-RESET-TOKEN```

## Авторизация

Перед авторизацией на сервисе нужно зарегистрироваться и подтвердить свою почту. Также нужно узнать или сгенерировать ```client_id``` и ```client_secret```.

Для авторизации нужно выполнить запрос ```/token/auth``` указав свою почту, пароль, ```client_id``` и ```client_secret```.
В результате запроса получим: 
 * тип авторизации;
 * время жизни токена; 
 * токен для обновления;
 * токена авторизации;

Далее для доступа к сервису нужно будет добавлять в header параметр ```Authorization``` с полученным токеном авторизации.

### Обновление токена пользователя 

Для обновления токена пользователя, нужно выполнить запрос ```/token/update```. Подробнее смотреть в swagger.

### Сброс токена

Для сброса токенов, нужно выполнить запрос ```/api/logout```. Подробнее смотреть в swagger.

## Admin

Для получения прав на работу с административной частью нужно выполнить команду, где в поле <email> нужно указать электронную почту которая была зарегистрирована и подтверждена:
```bash
$ ./bin/console user:add-role <email> ROLE_ADMIN
```

После этого будут доступны следующие методы:
 * ```/api/admin/user/list``` получить список всех электронных почт зарегистрированных на сервисе;
 * ```/api/admin/user/block``` указанный пользователь будет заблокирован;
 * ```/api/admin/user/delete``` указанный пользователь будет удален;
 * ```/api/admin/users/send``` отправить сообщение всем зарегистрированным пользователям;

# Доступные консольные команды
 * ```$ ./bin/console user:add-role <email> <role> ``` добавляем пользователю <email> новую роль указанную в <role>, доступны ROLE_ADMIN ROLE_USER IS_AUTHENTICATED_FULLY, 
 * ```$ ./bin/concole user:deactivate <email> ``` деактивируем указанного пользователя <email>;
 * ```$ ./bin/concole user:activated <email> ``` активируем указанного пользователя <email>;
 * ```$ ./bin/concole import:cars ``` импортируем автомобили из каталога var/imports.
